# PostgreSQL Configuration for Legal RAG System
# Optimized for vector similarity search with pgvector

# Connection settings
max_connections = 100
shared_buffers = 256MB           # 25% of RAM for 1GB container
effective_cache_size = 768MB     # 75% of RAM
work_mem = 16MB                  # Per-operation memory
maintenance_work_mem = 64MB      # For index creation

# Query planning
random_page_cost = 1.1           # SSD-optimized
effective_io_concurrency = 200   # SSD parallelism

# Logging (for debugging)
log_destination = 'stderr'
logging_collector = on
log_directory = 'log'
log_filename = 'postgresql-%Y-%m-%d.log'
log_statement = 'mod'            # Log all DDL
log_duration = off
log_min_duration_statement = 1000  # Log slow queries (>1s)
log_line_prefix = '%t [%p] %u@%d '

# Checkpoints
checkpoint_completion_target = 0.9
wal_buffers = 16MB

# Vector search optimization
# These help with IVFFlat index performance
enable_seqscan = on              # Allow seq scans for small tables
enable_indexscan = on
enable_bitmapscan = on
